// src/components/LiveDashboard.jsx
import React, { useEffect, useState } from "react";
import { Paper, Typography, Box, Divider, List, ListItem, ListItemText } from "@mui/material";
import { getCryptoPrices } from "../utils/priceService";

const LiveDashboard = () => {
  const [prices, setPrices] = useState(null);
  const [advice, setAdvice] = useState([]);

  useEffect(() => {
    const fetchPrices = async () => {
      const result = await getCryptoPrices();
      setPrices(result);

      const tips = [];
      if (result.BTC > 1200000) tips.push("ğŸ“ˆ BTC yÃ¼ksek, kÃ¢r realizasyonu dÃ¼ÅŸÃ¼nebilirsin.");
      if (result.ETH < 30000) tips.push("ğŸ“‰ ETH dÃ¼ÅŸÃ¼ÅŸte, alÄ±m fÄ±rsatÄ± olabilir.");
      if (result.USD > 40) tips.push("ğŸ“ˆ Dolar kuru yÃ¼kseliyor, dÃ¶viz pozisyonu korunabilir.");

      setAdvice(tips);
    };

    fetchPrices();
  }, []);

  return (
    <Paper sx={{ p: 3, mt: 3 }}>
      <Typography variant="h6">ğŸŒ CanlÄ± Piyasa Takibi</Typography>
      {prices ? (
        <Box sx={{ mt: 2 }}>
          <Typography>BTC: {prices.BTC.toLocaleString()} â‚º</Typography>
          <Typography>ETH: {prices.ETH.toLocaleString()} â‚º</Typography>
          <Typography>USD: {prices.USD.toFixed(2)} â‚º</Typography>
          <Typography>EUR: {prices.EUR.toFixed(2)} â‚º</Typography>
          <Typography>AltÄ±n: {prices.GOLD.toFixed(2)} â‚º</Typography>
        </Box>
      ) : (
        <Typography>Veriler yÃ¼kleniyor...</Typography>
      )}

      <Divider sx={{ my: 2 }}>ğŸ“¢ Tavsiyeler</Divider>
      <List>
        {advice.map((item, i) => (
          <ListItem key={i}><ListItemText primary={item} /></ListItem>
        ))}
      </List>
    </Paper>
  );
};

export default LiveDashboard;